nginx設定ファイル格納先
cd /etc/nginx

コンフィグの場所
/etc/nginx/nginx.conf

コンフィグ編集
sudo nano /etc/nginx/nginx.conf

スタート
systemctl start nginx

接続維持可能
systemctl reload nginx

エラー確認
nginx -t



Pythonでnginxのコンフィグを書き換える処理

プログラムの説明
異常があったらPythonのファイル書き込みを利用し、コンフィグを書き換える。
その後適用させる為にリロード。このリロードはコネクションの維持ができるので
コンフィグの設定を変えている際、ユーザが検索システムを使っていても問題ない！

1つだけ問題が…
あらかじめ用意した重みづけ文字列を
ファイルに書き込んでいる方式なのでサーバ2台が同時に極端に遅くなった場合、
重みづけを両方に適用できない。
→NGINXはコンフィグを分けてinclude出来るらしいのでそれで解決できるかも。（そのうちやる）


Pythonでロードバランスの設定を書き換
ロードバランサの重みづけをPythonで





総合評価をどうするか悩んでいる。


応答速度をロードバランサの指標として使うには
両方の評価（「平均応答速度」＋「現在の応答速度」）を加味した総合評価が必要になる。

例：現在の応答速はD、平均速はAだったとする。
これは、基本的に早いサーバだが接続時は速度が遅くなっていると考えられる。
しばらく待てば回復する→平均を重視すべき。
何かのトラブルでずっと遅い状態が続く→現在の応答速を重視すべき。

それぞれのサーバ評価はどうやって付ければいいんだろう？

難しいことはよくわかんないので

応答速度をロードバランサの指標として使うには
両方の評価（「平均応答速度」＋「現在の応答速度」）を加味した総合評価が必要になる。

例：現在の応答速はD、平均速はAだったとする。
これは、基本的に早いサーバだが接続時は速度が遅くなっていると考えられる。
しばらく待てば回復する→平均を重視すべき。
何かのトラブルでずっと遅い状態が続く→現在の応答速を重視すべき。

それぞれのサーバ評価はどうやって付ければいいんだろう？

皆さんの意見を取り入れたいので
とりあえず、平均、現在の評価で総合評価するのは後回しにして、

ＬＢでは「現在の応答速度が極端に遅いサーバ」の重みづけを下げることにした。










